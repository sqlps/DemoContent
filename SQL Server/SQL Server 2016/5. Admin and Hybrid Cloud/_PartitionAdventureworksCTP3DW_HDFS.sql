USE [AdventureworksDW2016CTP3_HDFS]
GO
BEGIN TRANSACTION
CREATE PARTITION FUNCTION [pf_OrderDate](datetime) AS RANGE LEFT FOR VALUES (N'2005-01-01T00:00:00', N'2006-01-01T00:00:00', N'2007-01-01T00:00:00', N'2008-01-01T00:00:00', N'2009-01-01T00:00:00', N'2010-01-01T00:00:00', N'2011-01-01T00:00:00', N'2012-01-01T00:00:00', N'2013-01-01T00:00:00', N'2014-01-01T00:00:00', N'2015-01-01T00:00:00')


CREATE PARTITION SCHEME [ps_OrderDate] AS PARTITION [pf_OrderDate] TO ([2004], [2005], [2006], [2007], [2008], [2009], [2010], [2011], [2012], [2013], [2014], [2015])






ALTER TABLE [dbo].[FactResellerSalesXL_PageCompressed] DROP CONSTRAINT [PK_FactResellerSalesXL_PageCompressed_SalesOrderNumber_SalesOrderLineNumber]


ALTER TABLE [dbo].[FactResellerSalesXL_PageCompressed] ADD  CONSTRAINT [PK_FactResellerSalesXL_PageCompressed_SalesOrderNumber_SalesOrderLineNumber] PRIMARY KEY NONCLUSTERED 
(
	[SalesOrderNumber] ASC,
	[SalesOrderLineNumber] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]


CREATE CLUSTERED INDEX [ClusteredIndex_on_ps_OrderDate_636215643649404985] ON [dbo].[FactResellerSalesXL_PageCompressed]
(
	[OrderDate]
)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, DATA_COMPRESSION = PAGE ON PARTITIONS (1 TO 12)) ON [ps_OrderDate]([OrderDate])


DROP INDEX [ClusteredIndex_on_ps_OrderDate_636215643649404985] ON [dbo].[FactResellerSalesXL_PageCompressed]








COMMIT TRANSACTION




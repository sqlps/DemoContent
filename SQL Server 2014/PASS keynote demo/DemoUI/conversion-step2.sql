USE Fabrikam
GO
DROP PROCEDURE sp_find_recommended_apps
GO
CREATE PROCEDURE sp_find_recommended_apps
	@AppId int, @CustomerId int
WITH NATIVE_COMPILATION, SCHEMABINDING, EXECUTE AS OWNER
AS BEGIN ATOMIC WITH (TRANSACTION ISOLATION LEVEL = SNAPSHOT, LANGUAGE = N'English')
	DECLARE @custCri000 float,@custCri001 float,@custCri002 float,@custCri003 float,@custCri004 float,@custCri005 float,@custCri006 float,@custCri007 float,@custCri008 float,@custCri009 float,@custCri010 float,@custCri011 float,@custCri012 float,@custCri013 float,@custCri014 float,@custCri015 float,@custCri016 float,@custCri017 float,@custCri018 float,@custCri019 float,@custCri020 float,@custCri021 float,@custCri022 float,@custCri023 float,@custCri024 float,@custCri025 float,@custCri026 float,@custCri027 float,@custCri028 float,@custCri029 float,@custCri030 float,@custCri031 float,@custCri032 float,@custCri033 float,@custCri034 float,@custCri035 float,@custCri036 float,@custCri037 float,@custCri038 float,@custCri039 float,@custCri040 float,@custCri041 float,@custCri042 float,@custCri043 float,@custCri044 float,@custCri045 float,@custCri046 float,@custCri047 float,@custCri048 float,@custCri049 float,@custCri050 float,@custCri051 float,@custCri052 float,@custCri053 float,@custCri054 float,@custCri055 float,@custCri056 float,@custCri057 float,@custCri058 float,@custCri059 float,@custCri060 float,@custCri061 float,@custCri062 float,@custCri063 float,@custCri064 float,@custCri065 float,@custCri066 float,@custCri067 float,@custCri068 float,@custCri069 float,@custCri070 float,@custCri071 float,@custCri072 float,@custCri073 float,@custCri074 float,@custCri075 float,@custCri076 float,@custCri077 float,@custCri078 float,@custCri079 float,@custCri080 float,@custCri081 float,@custCri082 float,@custCri083 float,@custCri084 float,@custCri085 float,@custCri086 float,@custCri087 float,@custCri088 float,@custCri089 float,@custCri090 float,@custCri091 float,@custCri092 float,@custCri093 float,@custCri094 float,@custCri095 float,@custCri096 float,@custCri097 float,@custCri098 float,@custCri099 float,@custCri100 float,@custCri101 float,@custCri102 float,@custCri103 float,@custCri104 float,@custCri105 float,@custCri106 float,@custCri107 float,@custCri108 float,@custCri109 float,@custCri110 float,@custCri111 float,@custCri112 float,@custCri113 float,@custCri114 float,@custCri115 float,@custCri116 float,@custCri117 float,@custCri118 float,@custCri119 float,@custCri120 float,@custCri121 float,@custCri122 float,@custCri123 float,@custCri124 float,@custCri125 float,@custCri126 float,@custCri127 float,@custCri128 float,@custCri129 float,@custCri130 float,@custCri131 float,@custCri132 float,@custCri133 float,@custCri134 float,@custCri135 float,@custCri136 float,@custCri137 float,@custCri138 float,@custCri139 float,@custCri140 float,@custCri141 float,@custCri142 float,@custCri143 float,@custCri144 float,@custCri145 float,@custCri146 float,@custCri147 float,@custCri148 float,@custCri149 float,@custCri150 float,@custCri151 float,@custCri152 float,@custCri153 float,@custCri154 float,@custCri155 float,@custCri156 float,@custCri157 float,@custCri158 float,@custCri159 float,@custCri160 float,@custCri161 float,@custCri162 float,@custCri163 float,@custCri164 float,@custCri165 float,@custCri166 float,@custCri167 float,@custCri168 float,@custCri169 float,@custCri170 float,@custCri171 float,@custCri172 float,@custCri173 float,@custCri174 float,@custCri175 float,@custCri176 float,@custCri177 float,@custCri178 float,@custCri179 float,@custCri180 float,@custCri181 float,@custCri182 float,@custCri183 float,@custCri184 float,@custCri185 float,@custCri186 float,@custCri187 float,@custCri188 float,@custCri189 float,@custCri190 float,@custCri191 float,@custCri192 float,@custCri193 float,@custCri194 float,@custCri195 float,@custCri196 float,@custCri197 float,@custCri198 float,@custCri199 float,@custCri200 float,@custCri201 float,@custCri202 float,@custCri203 float,@custCri204 float,@custCri205 float,@custCri206 float,@custCri207 float,@custCri208 float,@custCri209 float,@custCri210 float,@custCri211 float,@custCri212 float,@custCri213 float,@custCri214 float,@custCri215 float,@custCri216 float,@custCri217 float,@custCri218 float,@custCri219 float,@custCri220 float,@custCri221 float,@custCri222 float,@custCri223 float,@custCri224 float,@custCri225 float,@custCri226 float,@custCri227 float,@custCri228 float,@custCri229 float,@custCri230 float,@custCri231 float,@custCri232 float,@custCri233 float,@custCri234 float,@custCri235 float,@custCri236 float,@custCri237 float,@custCri238 float,@custCri239 float,@custCri240 float,@custCri241 float,@custCri242 float,@custCri243 float,@custCri244 float,@custCri245 float,@custCri246 float,@custCri247 float,@custCri248 float,@custCri249 float,@custCri250 float,@custCri251 float,@custCri252 float,@custCri253 float,@custCri254 float,@custCri255 float,@custCri256 float,@custCri257 float,@custCri258 float,@custCri259 float,@custCri260 float,@custCri261 float,@custCri262 float,@custCri263 float,@custCri264 float,@custCri265 float,@custCri266 float,@custCri267 float,@custCri268 float,@custCri269 float,@custCri270 float,@custCri271 float,@custCri272 float,@custCri273 float,@custCri274 float,@custCri275 float,@custCri276 float,@custCri277 float,@custCri278 float,@custCri279 float,@custCri280 float,@custCri281 float,@custCri282 float,@custCri283 float,@custCri284 float,@custCri285 float,@custCri286 float,@custCri287 float,@custCri288 float,@custCri289 float,@custCri290 float,@custCri291 float,@custCri292 float,@custCri293 float,@custCri294 float,@custCri295 float,@custCri296 float,@custCri297 float,@custCri298 float,@custCri299 float,@custCri300 float,@custCri301 float,@custCri302 float,@custCri303 float,@custCri304 float,@custCri305 float,@custCri306 float,@custCri307 float,@custCri308 float,@custCri309 float,@custCri310 float,@custCri311 float,@custCri312 float,@custCri313 float,@custCri314 float,@custCri315 float,@custCri316 float,@custCri317 float,@custCri318 float,@custCri319 float,@custCri320 float,@custCri321 float,@custCri322 float,@custCri323 float,@custCri324 float,@custCri325 float,@custCri326 float,@custCri327 float,@custCri328 float,@custCri329 float,@custCri330 float,@custCri331 float,@custCri332 float,@custCri333 float,@custCri334 float,@custCri335 float,@custCri336 float,@custCri337 float,@custCri338 float,@custCri339 float,@custCri340 float,@custCri341 float,@custCri342 float,@custCri343 float,@custCri344 float,@custCri345 float,@custCri346 float,@custCri347 float,@custCri348 float,@custCri349 float,@custCri350 float,@custCri351 float,@custCri352 float,@custCri353 float,@custCri354 float,@custCri355 float,@custCri356 float,@custCri357 float,@custCri358 float,@custCri359 float,@custCri360 float,@custCri361 float,@custCri362 float,@custCri363 float,@custCri364 float,@custCri365 float,@custCri366 float,@custCri367 float,@custCri368 float,@custCri369 float,@custCri370 float,@custCri371 float,@custCri372 float,@custCri373 float,@custCri374 float,@custCri375 float,@custCri376 float,@custCri377 float,@custCri378 float,@custCri379 float,@custCri380 float,@custCri381 float,@custCri382 float,@custCri383 float,@custCri384 float,@custCri385 float,@custCri386 float,@custCri387 float,@custCri388 float,@custCri389 float,@custCri390 float,@custCri391 float,@custCri392 float,@custCri393 float,@custCri394 float,@custCri395 float,@custCri396 float,@custCri397 float,@custCri398 float,@custCri399 float

	SELECT 
	@custCri000=Criterion000,@custCri001=Criterion001,@custCri002=Criterion002,@custCri003=Criterion003,@custCri004=Criterion004,@custCri005=Criterion005,@custCri006=Criterion006,@custCri007=Criterion007,@custCri008=Criterion008,@custCri009=Criterion009,@custCri010=Criterion010,@custCri011=Criterion011,@custCri012=Criterion012,@custCri013=Criterion013,@custCri014=Criterion014,@custCri015=Criterion015,@custCri016=Criterion016,@custCri017=Criterion017,@custCri018=Criterion018,@custCri019=Criterion019,@custCri020=Criterion020,@custCri021=Criterion021,@custCri022=Criterion022,@custCri023=Criterion023,@custCri024=Criterion024,@custCri025=Criterion025,@custCri026=Criterion026,@custCri027=Criterion027,@custCri028=Criterion028,@custCri029=Criterion029,@custCri030=Criterion030,@custCri031=Criterion031,@custCri032=Criterion032,@custCri033=Criterion033,@custCri034=Criterion034,@custCri035=Criterion035,@custCri036=Criterion036,@custCri037=Criterion037,@custCri038=Criterion038,@custCri039=Criterion039,@custCri040=Criterion040,@custCri041=Criterion041,@custCri042=Criterion042,@custCri043=Criterion043,@custCri044=Criterion044,@custCri045=Criterion045,@custCri046=Criterion046,@custCri047=Criterion047,@custCri048=Criterion048,@custCri049=Criterion049,@custCri050=Criterion050,@custCri051=Criterion051,@custCri052=Criterion052,@custCri053=Criterion053,@custCri054=Criterion054,@custCri055=Criterion055,@custCri056=Criterion056,@custCri057=Criterion057,@custCri058=Criterion058,@custCri059=Criterion059,@custCri060=Criterion060,@custCri061=Criterion061,@custCri062=Criterion062,@custCri063=Criterion063,@custCri064=Criterion064,@custCri065=Criterion065,@custCri066=Criterion066,@custCri067=Criterion067,@custCri068=Criterion068,@custCri069=Criterion069,@custCri070=Criterion070,@custCri071=Criterion071,@custCri072=Criterion072,@custCri073=Criterion073,@custCri074=Criterion074,@custCri075=Criterion075,@custCri076=Criterion076,@custCri077=Criterion077,@custCri078=Criterion078,@custCri079=Criterion079,@custCri080=Criterion080,@custCri081=Criterion081,@custCri082=Criterion082,@custCri083=Criterion083,@custCri084=Criterion084,@custCri085=Criterion085,@custCri086=Criterion086,@custCri087=Criterion087,@custCri088=Criterion088,@custCri089=Criterion089,@custCri090=Criterion090,@custCri091=Criterion091,@custCri092=Criterion092,@custCri093=Criterion093,@custCri094=Criterion094,@custCri095=Criterion095,@custCri096=Criterion096,@custCri097=Criterion097,@custCri098=Criterion098,@custCri099=Criterion099,@custCri100=Criterion100,@custCri101=Criterion101,@custCri102=Criterion102,@custCri103=Criterion103,@custCri104=Criterion104,@custCri105=Criterion105,@custCri106=Criterion106,@custCri107=Criterion107,@custCri108=Criterion108,@custCri109=Criterion109,@custCri110=Criterion110,@custCri111=Criterion111,@custCri112=Criterion112,@custCri113=Criterion113,@custCri114=Criterion114,@custCri115=Criterion115,@custCri116=Criterion116,@custCri117=Criterion117,@custCri118=Criterion118,@custCri119=Criterion119,@custCri120=Criterion120,@custCri121=Criterion121,@custCri122=Criterion122,@custCri123=Criterion123,@custCri124=Criterion124,@custCri125=Criterion125,@custCri126=Criterion126,@custCri127=Criterion127,@custCri128=Criterion128,@custCri129=Criterion129,@custCri130=Criterion130,@custCri131=Criterion131,@custCri132=Criterion132,@custCri133=Criterion133,@custCri134=Criterion134,@custCri135=Criterion135,@custCri136=Criterion136,@custCri137=Criterion137,@custCri138=Criterion138,@custCri139=Criterion139,@custCri140=Criterion140,@custCri141=Criterion141,@custCri142=Criterion142,@custCri143=Criterion143,@custCri144=Criterion144,@custCri145=Criterion145,@custCri146=Criterion146,@custCri147=Criterion147,@custCri148=Criterion148,@custCri149=Criterion149,@custCri150=Criterion150,@custCri151=Criterion151,@custCri152=Criterion152,@custCri153=Criterion153,@custCri154=Criterion154,@custCri155=Criterion155,@custCri156=Criterion156,@custCri157=Criterion157,@custCri158=Criterion158,@custCri159=Criterion159,@custCri160=Criterion160,@custCri161=Criterion161,@custCri162=Criterion162,@custCri163=Criterion163,@custCri164=Criterion164,@custCri165=Criterion165,@custCri166=Criterion166,@custCri167=Criterion167,@custCri168=Criterion168,@custCri169=Criterion169,@custCri170=Criterion170,@custCri171=Criterion171,@custCri172=Criterion172,@custCri173=Criterion173,@custCri174=Criterion174,@custCri175=Criterion175,@custCri176=Criterion176,@custCri177=Criterion177,@custCri178=Criterion178,@custCri179=Criterion179,@custCri180=Criterion180,@custCri181=Criterion181,@custCri182=Criterion182,@custCri183=Criterion183,@custCri184=Criterion184,@custCri185=Criterion185,@custCri186=Criterion186,@custCri187=Criterion187,@custCri188=Criterion188,@custCri189=Criterion189,@custCri190=Criterion190,@custCri191=Criterion191,@custCri192=Criterion192,@custCri193=Criterion193,@custCri194=Criterion194,@custCri195=Criterion195,@custCri196=Criterion196,@custCri197=Criterion197,@custCri198=Criterion198,@custCri199=Criterion199,@custCri200=Criterion200,@custCri201=Criterion201,@custCri202=Criterion202,@custCri203=Criterion203,@custCri204=Criterion204,@custCri205=Criterion205,@custCri206=Criterion206,@custCri207=Criterion207,@custCri208=Criterion208,@custCri209=Criterion209,@custCri210=Criterion210,@custCri211=Criterion211,@custCri212=Criterion212,@custCri213=Criterion213,@custCri214=Criterion214,@custCri215=Criterion215,@custCri216=Criterion216,@custCri217=Criterion217,@custCri218=Criterion218,@custCri219=Criterion219,@custCri220=Criterion220,@custCri221=Criterion221,@custCri222=Criterion222,@custCri223=Criterion223,@custCri224=Criterion224,@custCri225=Criterion225,@custCri226=Criterion226,@custCri227=Criterion227,@custCri228=Criterion228,@custCri229=Criterion229,@custCri230=Criterion230,@custCri231=Criterion231,@custCri232=Criterion232,@custCri233=Criterion233,@custCri234=Criterion234,@custCri235=Criterion235,@custCri236=Criterion236,@custCri237=Criterion237,@custCri238=Criterion238,@custCri239=Criterion239,@custCri240=Criterion240,@custCri241=Criterion241,@custCri242=Criterion242,@custCri243=Criterion243,@custCri244=Criterion244,@custCri245=Criterion245,@custCri246=Criterion246,@custCri247=Criterion247,@custCri248=Criterion248,@custCri249=Criterion249,@custCri250=Criterion250,@custCri251=Criterion251,@custCri252=Criterion252,@custCri253=Criterion253,@custCri254=Criterion254,@custCri255=Criterion255,@custCri256=Criterion256,@custCri257=Criterion257,@custCri258=Criterion258,@custCri259=Criterion259,@custCri260=Criterion260,@custCri261=Criterion261,@custCri262=Criterion262,@custCri263=Criterion263,@custCri264=Criterion264,@custCri265=Criterion265,@custCri266=Criterion266,@custCri267=Criterion267,@custCri268=Criterion268,@custCri269=Criterion269,@custCri270=Criterion270,@custCri271=Criterion271,@custCri272=Criterion272,@custCri273=Criterion273,@custCri274=Criterion274,@custCri275=Criterion275,@custCri276=Criterion276,@custCri277=Criterion277,@custCri278=Criterion278,@custCri279=Criterion279,@custCri280=Criterion280,@custCri281=Criterion281,@custCri282=Criterion282,@custCri283=Criterion283,@custCri284=Criterion284,@custCri285=Criterion285,@custCri286=Criterion286,@custCri287=Criterion287,@custCri288=Criterion288,@custCri289=Criterion289,@custCri290=Criterion290,@custCri291=Criterion291,@custCri292=Criterion292,@custCri293=Criterion293,@custCri294=Criterion294,@custCri295=Criterion295,@custCri296=Criterion296,@custCri297=Criterion297,@custCri298=Criterion298,@custCri299=Criterion299,@custCri300=Criterion300,@custCri301=Criterion301,@custCri302=Criterion302,@custCri303=Criterion303,@custCri304=Criterion304,@custCri305=Criterion305,@custCri306=Criterion306,@custCri307=Criterion307,@custCri308=Criterion308,@custCri309=Criterion309,@custCri310=Criterion310,@custCri311=Criterion311,@custCri312=Criterion312,@custCri313=Criterion313,@custCri314=Criterion314,@custCri315=Criterion315,@custCri316=Criterion316,@custCri317=Criterion317,@custCri318=Criterion318,@custCri319=Criterion319,@custCri320=Criterion320,@custCri321=Criterion321,@custCri322=Criterion322,@custCri323=Criterion323,@custCri324=Criterion324,@custCri325=Criterion325,@custCri326=Criterion326,@custCri327=Criterion327,@custCri328=Criterion328,@custCri329=Criterion329,@custCri330=Criterion330,@custCri331=Criterion331,@custCri332=Criterion332,@custCri333=Criterion333,@custCri334=Criterion334,@custCri335=Criterion335,@custCri336=Criterion336,@custCri337=Criterion337,@custCri338=Criterion338,@custCri339=Criterion339,@custCri340=Criterion340,@custCri341=Criterion341,@custCri342=Criterion342,@custCri343=Criterion343,@custCri344=Criterion344,@custCri345=Criterion345,@custCri346=Criterion346,@custCri347=Criterion347,@custCri348=Criterion348,@custCri349=Criterion349,@custCri350=Criterion350,@custCri351=Criterion351,@custCri352=Criterion352,@custCri353=Criterion353,@custCri354=Criterion354,@custCri355=Criterion355,@custCri356=Criterion356,@custCri357=Criterion357,@custCri358=Criterion358,@custCri359=Criterion359,@custCri360=Criterion360,@custCri361=Criterion361,@custCri362=Criterion362,@custCri363=Criterion363,@custCri364=Criterion364,@custCri365=Criterion365,@custCri366=Criterion366,@custCri367=Criterion367,@custCri368=Criterion368,@custCri369=Criterion369,@custCri370=Criterion370,@custCri371=Criterion371,@custCri372=Criterion372,@custCri373=Criterion373,@custCri374=Criterion374,@custCri375=Criterion375,@custCri376=Criterion376,@custCri377=Criterion377,@custCri378=Criterion378,@custCri379=Criterion379,@custCri380=Criterion380,@custCri381=Criterion381,@custCri382=Criterion382,@custCri383=Criterion383,@custCri384=Criterion384,@custCri385=Criterion385,@custCri386=Criterion386,@custCri387=Criterion387,@custCri388=Criterion388,@custCri389=Criterion389,@custCri390=Criterion390,@custCri391=Criterion391,@custCri392=Criterion392,@custCri393=Criterion393,@custCri394=Criterion394,@custCri395=Criterion395,@custCri396=Criterion396,@custCri397=Criterion397,@custCri398=Criterion398,@custCri399=Criterion399
	FROM dbo.customer_preference WHERE CustomerId = @CustomerId

	SELECT TOP 5 AppId, ((@custCri000/Criterion000-1)+(@custCri001/Criterion001-1)+(@custCri002/Criterion002-1)+(@custCri003/Criterion003-1)+(@custCri004/Criterion004-1)+(@custCri005/Criterion005-1)+(@custCri006/Criterion006-1)+(@custCri007/Criterion007-1)+(@custCri008/Criterion008-1)+(@custCri009/Criterion009-1)+(@custCri010/Criterion010-1)+(@custCri011/Criterion011-1)+(@custCri012/Criterion012-1)+(@custCri013/Criterion013-1)+(@custCri014/Criterion014-1)+(@custCri015/Criterion015-1)+(@custCri016/Criterion016-1)+(@custCri017/Criterion017-1)+(@custCri018/Criterion018-1)+(@custCri019/Criterion019-1)+(@custCri020/Criterion020-1)+(@custCri021/Criterion021-1)+(@custCri022/Criterion022-1)+(@custCri023/Criterion023-1)+(@custCri024/Criterion024-1)+(@custCri025/Criterion025-1)+(@custCri026/Criterion026-1)+(@custCri027/Criterion027-1)+(@custCri028/Criterion028-1)+(@custCri029/Criterion029-1)+(@custCri030/Criterion030-1)+(@custCri031/Criterion031-1)+(@custCri032/Criterion032-1)+(@custCri033/Criterion033-1)+(@custCri034/Criterion034-1)+(@custCri035/Criterion035-1)+(@custCri036/Criterion036-1)+(@custCri037/Criterion037-1)+(@custCri038/Criterion038-1)+(@custCri039/Criterion039-1)+(@custCri040/Criterion040-1)+(@custCri041/Criterion041-1)+(@custCri042/Criterion042-1)+(@custCri043/Criterion043-1)+(@custCri044/Criterion044-1)+(@custCri045/Criterion045-1)+(@custCri046/Criterion046-1)+(@custCri047/Criterion047-1)+(@custCri048/Criterion048-1)+(@custCri049/Criterion049-1)+(@custCri050/Criterion050-1)+(@custCri051/Criterion051-1)+(@custCri052/Criterion052-1)+(@custCri053/Criterion053-1)+(@custCri054/Criterion054-1)+(@custCri055/Criterion055-1)+(@custCri056/Criterion056-1)+(@custCri057/Criterion057-1)+(@custCri058/Criterion058-1)+(@custCri059/Criterion059-1)+(@custCri060/Criterion060-1)+(@custCri061/Criterion061-1)+(@custCri062/Criterion062-1)+(@custCri063/Criterion063-1)+(@custCri064/Criterion064-1)+(@custCri065/Criterion065-1)+(@custCri066/Criterion066-1)+(@custCri067/Criterion067-1)+(@custCri068/Criterion068-1)+(@custCri069/Criterion069-1)+(@custCri070/Criterion070-1)+(@custCri071/Criterion071-1)+(@custCri072/Criterion072-1)+(@custCri073/Criterion073-1)+(@custCri074/Criterion074-1)+(@custCri075/Criterion075-1)+(@custCri076/Criterion076-1)+(@custCri077/Criterion077-1)+(@custCri078/Criterion078-1)+(@custCri079/Criterion079-1)+(@custCri080/Criterion080-1)+(@custCri081/Criterion081-1)+(@custCri082/Criterion082-1)+(@custCri083/Criterion083-1)+(@custCri084/Criterion084-1)+(@custCri085/Criterion085-1)+(@custCri086/Criterion086-1)+(@custCri087/Criterion087-1)+(@custCri088/Criterion088-1)+(@custCri089/Criterion089-1)+(@custCri090/Criterion090-1)+(@custCri091/Criterion091-1)+(@custCri092/Criterion092-1)+(@custCri093/Criterion093-1)+(@custCri094/Criterion094-1)+(@custCri095/Criterion095-1)+(@custCri096/Criterion096-1)+(@custCri097/Criterion097-1)+(@custCri098/Criterion098-1)+(@custCri099/Criterion099-1)+(@custCri100/Criterion100-1)+(@custCri101/Criterion101-1)+(@custCri102/Criterion102-1)+(@custCri103/Criterion103-1)+(@custCri104/Criterion104-1)+(@custCri105/Criterion105-1)+(@custCri106/Criterion106-1)+(@custCri107/Criterion107-1)+(@custCri108/Criterion108-1)+(@custCri109/Criterion109-1)+(@custCri110/Criterion110-1)+(@custCri111/Criterion111-1)+(@custCri112/Criterion112-1)+(@custCri113/Criterion113-1)+(@custCri114/Criterion114-1)+(@custCri115/Criterion115-1)+(@custCri116/Criterion116-1)+(@custCri117/Criterion117-1)+(@custCri118/Criterion118-1)+(@custCri119/Criterion119-1)+(@custCri120/Criterion120-1)+(@custCri121/Criterion121-1)+(@custCri122/Criterion122-1)+(@custCri123/Criterion123-1)+(@custCri124/Criterion124-1)+(@custCri125/Criterion125-1)+(@custCri126/Criterion126-1)+(@custCri127/Criterion127-1)+(@custCri128/Criterion128-1)+(@custCri129/Criterion129-1)+(@custCri130/Criterion130-1)+(@custCri131/Criterion131-1)+(@custCri132/Criterion132-1)+(@custCri133/Criterion133-1)+(@custCri134/Criterion134-1)+(@custCri135/Criterion135-1)+(@custCri136/Criterion136-1)+(@custCri137/Criterion137-1)+(@custCri138/Criterion138-1)+(@custCri139/Criterion139-1)+(@custCri140/Criterion140-1)+(@custCri141/Criterion141-1)+(@custCri142/Criterion142-1)+(@custCri143/Criterion143-1)+(@custCri144/Criterion144-1)+(@custCri145/Criterion145-1)+(@custCri146/Criterion146-1)+(@custCri147/Criterion147-1)+(@custCri148/Criterion148-1)+(@custCri149/Criterion149-1)+(@custCri150/Criterion150-1)+(@custCri151/Criterion151-1)+(@custCri152/Criterion152-1)+(@custCri153/Criterion153-1)+(@custCri154/Criterion154-1)+(@custCri155/Criterion155-1)+(@custCri156/Criterion156-1)+(@custCri157/Criterion157-1)+(@custCri158/Criterion158-1)+(@custCri159/Criterion159-1)+(@custCri160/Criterion160-1)+(@custCri161/Criterion161-1)+(@custCri162/Criterion162-1)+(@custCri163/Criterion163-1)+(@custCri164/Criterion164-1)+(@custCri165/Criterion165-1)+(@custCri166/Criterion166-1)+(@custCri167/Criterion167-1)+(@custCri168/Criterion168-1)+(@custCri169/Criterion169-1)+(@custCri170/Criterion170-1)+(@custCri171/Criterion171-1)+(@custCri172/Criterion172-1)+(@custCri173/Criterion173-1)+(@custCri174/Criterion174-1)+(@custCri175/Criterion175-1)+(@custCri176/Criterion176-1)+(@custCri177/Criterion177-1)+(@custCri178/Criterion178-1)+(@custCri179/Criterion179-1)+(@custCri180/Criterion180-1)+(@custCri181/Criterion181-1)+(@custCri182/Criterion182-1)+(@custCri183/Criterion183-1)+(@custCri184/Criterion184-1)+(@custCri185/Criterion185-1)+(@custCri186/Criterion186-1)+(@custCri187/Criterion187-1)+(@custCri188/Criterion188-1)+(@custCri189/Criterion189-1)+(@custCri190/Criterion190-1)+(@custCri191/Criterion191-1)+(@custCri192/Criterion192-1)+(@custCri193/Criterion193-1)+(@custCri194/Criterion194-1)+(@custCri195/Criterion195-1)+(@custCri196/Criterion196-1)+(@custCri197/Criterion197-1)+(@custCri198/Criterion198-1)+(@custCri199/Criterion199-1)+(@custCri200/Criterion200-1)+(@custCri201/Criterion201-1)+(@custCri202/Criterion202-1)+(@custCri203/Criterion203-1)+(@custCri204/Criterion204-1)+(@custCri205/Criterion205-1)+(@custCri206/Criterion206-1)+(@custCri207/Criterion207-1)+(@custCri208/Criterion208-1)+(@custCri209/Criterion209-1)+(@custCri210/Criterion210-1)+(@custCri211/Criterion211-1)+(@custCri212/Criterion212-1)+(@custCri213/Criterion213-1)+(@custCri214/Criterion214-1)+(@custCri215/Criterion215-1)+(@custCri216/Criterion216-1)+(@custCri217/Criterion217-1)+(@custCri218/Criterion218-1)+(@custCri219/Criterion219-1)+(@custCri220/Criterion220-1)+(@custCri221/Criterion221-1)+(@custCri222/Criterion222-1)+(@custCri223/Criterion223-1)+(@custCri224/Criterion224-1)+(@custCri225/Criterion225-1)+(@custCri226/Criterion226-1)+(@custCri227/Criterion227-1)+(@custCri228/Criterion228-1)+(@custCri229/Criterion229-1)+(@custCri230/Criterion230-1)+(@custCri231/Criterion231-1)+(@custCri232/Criterion232-1)+(@custCri233/Criterion233-1)+(@custCri234/Criterion234-1)+(@custCri235/Criterion235-1)+(@custCri236/Criterion236-1)+(@custCri237/Criterion237-1)+(@custCri238/Criterion238-1)+(@custCri239/Criterion239-1)+(@custCri240/Criterion240-1)+(@custCri241/Criterion241-1)+(@custCri242/Criterion242-1)+(@custCri243/Criterion243-1)+(@custCri244/Criterion244-1)+(@custCri245/Criterion245-1)+(@custCri246/Criterion246-1)+(@custCri247/Criterion247-1)+(@custCri248/Criterion248-1)+(@custCri249/Criterion249-1)+(@custCri250/Criterion250-1)+(@custCri251/Criterion251-1)+(@custCri252/Criterion252-1)+(@custCri253/Criterion253-1)+(@custCri254/Criterion254-1)+(@custCri255/Criterion255-1)+(@custCri256/Criterion256-1)+(@custCri257/Criterion257-1)+(@custCri258/Criterion258-1)+(@custCri259/Criterion259-1)+(@custCri260/Criterion260-1)+(@custCri261/Criterion261-1)+(@custCri262/Criterion262-1)+(@custCri263/Criterion263-1)+(@custCri264/Criterion264-1)+(@custCri265/Criterion265-1)+(@custCri266/Criterion266-1)+(@custCri267/Criterion267-1)+(@custCri268/Criterion268-1)+(@custCri269/Criterion269-1)+(@custCri270/Criterion270-1)+(@custCri271/Criterion271-1)+(@custCri272/Criterion272-1)+(@custCri273/Criterion273-1)+(@custCri274/Criterion274-1)+(@custCri275/Criterion275-1)+(@custCri276/Criterion276-1)+(@custCri277/Criterion277-1)+(@custCri278/Criterion278-1)+(@custCri279/Criterion279-1)+(@custCri280/Criterion280-1)+(@custCri281/Criterion281-1)+(@custCri282/Criterion282-1)+(@custCri283/Criterion283-1)+(@custCri284/Criterion284-1)+(@custCri285/Criterion285-1)+(@custCri286/Criterion286-1)+(@custCri287/Criterion287-1)+(@custCri288/Criterion288-1)+(@custCri289/Criterion289-1)+(@custCri290/Criterion290-1)+(@custCri291/Criterion291-1)+(@custCri292/Criterion292-1)+(@custCri293/Criterion293-1)+(@custCri294/Criterion294-1)+(@custCri295/Criterion295-1)+(@custCri296/Criterion296-1)+(@custCri297/Criterion297-1)+(@custCri298/Criterion298-1)+(@custCri299/Criterion299-1)+(@custCri300/Criterion300-1)+(@custCri301/Criterion301-1)+(@custCri302/Criterion302-1)+(@custCri303/Criterion303-1)+(@custCri304/Criterion304-1)+(@custCri305/Criterion305-1)+(@custCri306/Criterion306-1)+(@custCri307/Criterion307-1)+(@custCri308/Criterion308-1)+(@custCri309/Criterion309-1)+(@custCri310/Criterion310-1)+(@custCri311/Criterion311-1)+(@custCri312/Criterion312-1)+(@custCri313/Criterion313-1)+(@custCri314/Criterion314-1)+(@custCri315/Criterion315-1)+(@custCri316/Criterion316-1)+(@custCri317/Criterion317-1)+(@custCri318/Criterion318-1)+(@custCri319/Criterion319-1)+(@custCri320/Criterion320-1)+(@custCri321/Criterion321-1)+(@custCri322/Criterion322-1)+(@custCri323/Criterion323-1)+(@custCri324/Criterion324-1)+(@custCri325/Criterion325-1)+(@custCri326/Criterion326-1)+(@custCri327/Criterion327-1)+(@custCri328/Criterion328-1)+(@custCri329/Criterion329-1)+(@custCri330/Criterion330-1)+(@custCri331/Criterion331-1)+(@custCri332/Criterion332-1)+(@custCri333/Criterion333-1)+(@custCri334/Criterion334-1)+(@custCri335/Criterion335-1)+(@custCri336/Criterion336-1)+(@custCri337/Criterion337-1)+(@custCri338/Criterion338-1)+(@custCri339/Criterion339-1)+(@custCri340/Criterion340-1)+(@custCri341/Criterion341-1)+(@custCri342/Criterion342-1)+(@custCri343/Criterion343-1)+(@custCri344/Criterion344-1)+(@custCri345/Criterion345-1)+(@custCri346/Criterion346-1)+(@custCri347/Criterion347-1)+(@custCri348/Criterion348-1)+(@custCri349/Criterion349-1)+(@custCri350/Criterion350-1)+(@custCri351/Criterion351-1)+(@custCri352/Criterion352-1)+(@custCri353/Criterion353-1)+(@custCri354/Criterion354-1)+(@custCri355/Criterion355-1)+(@custCri356/Criterion356-1)+(@custCri357/Criterion357-1)+(@custCri358/Criterion358-1)+(@custCri359/Criterion359-1)+(@custCri360/Criterion360-1)+(@custCri361/Criterion361-1)+(@custCri362/Criterion362-1)+(@custCri363/Criterion363-1)+(@custCri364/Criterion364-1)+(@custCri365/Criterion365-1)+(@custCri366/Criterion366-1)+(@custCri367/Criterion367-1)+(@custCri368/Criterion368-1)+(@custCri369/Criterion369-1)+(@custCri370/Criterion370-1)+(@custCri371/Criterion371-1)+(@custCri372/Criterion372-1)+(@custCri373/Criterion373-1)+(@custCri374/Criterion374-1)+(@custCri375/Criterion375-1)+(@custCri376/Criterion376-1)+(@custCri377/Criterion377-1)+(@custCri378/Criterion378-1)+(@custCri379/Criterion379-1)+(@custCri380/Criterion380-1)+(@custCri381/Criterion381-1)+(@custCri382/Criterion382-1)+(@custCri383/Criterion383-1)+(@custCri384/Criterion384-1)+(@custCri385/Criterion385-1)+(@custCri386/Criterion386-1)+(@custCri387/Criterion387-1)+(@custCri388/Criterion388-1)+(@custCri389/Criterion389-1)+(@custCri390/Criterion390-1)+(@custCri391/Criterion391-1)+(@custCri392/Criterion392-1)+(@custCri393/Criterion393-1)+(@custCri394/Criterion394-1)+(@custCri395/Criterion395-1)+(@custCri396/Criterion396-1)+(@custCri397/Criterion397-1)+(@custCri398/Criterion398-1)+(@custCri399/Criterion399-1)) AS Closeness
	FROM dbo.app_criteria
	WHERE AppId != @AppId
	ORDER BY Closeness ASC
END
GO
EXEC sp_find_recommended_apps 1, 1
GO

USE FabrikamDev
GO
ALTER PROCEDURE [dbo].[sp_find_recommended_products]
	@productId int, @CustomerId int
AS BEGIN
	WAITFOR DELAY N'00:00:00.7'
	SELECT TOP 5 RecommendedProductId AS ProductId FROM product_recommendations WHERE purchasedProductid = @productId ORDER BY RecommendedWeight DESC
END
GO